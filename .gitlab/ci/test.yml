### TEST STAGE JOBS ###

lint:
  extends:
    - .nox
    - .rules_main_mr_skip_cache_update
  script:
    - uvx nox -e lint

minimum install:
  extends:
    - .nox
    - .rules_main_mr_code
  variables:
    PYTHON_VERSION: '3.10'
  script:
    - uvx nox -e deps

typecheck:
  extends:
    - .nox_all
    - .rules_main_mr_code
  script:
    - uvx nox -e type

test:
  extends:
    - .nox_all
    - .rules_main_mr
  script:
    - uvx nox -e test
  artifacts:
    reports:
      junit: output/junit.*.xml
    paths:
      - output/*

conda:
  extends:
    - .conda_all
    - .rules_main_mr_code
  script:
    - pytest -m 'not optional'

verify lock:
  extends:
    - .nox
    - .rules_main_mr_deps
  script:
    - uvx nox -e check